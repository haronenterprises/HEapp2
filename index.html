<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haron Enterprises, LLC - Residential Lease Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        body {
            background-color: #f8f7f4; 
            font-family: 'Inter', sans-serif;
        }
        @import url('https://rsms.me/inter/inter.css');
        .form-section {
            display: none;
        }
        .form-section.active {
            display: block;
        }
        .step-item-active {
            border-color: #3b82f6;
            color: #3b82f6;
        }
        .step-item-complete {
            border-color: #16a34a;
            color: #16a34a;
            background-color: #f0fdf4;
        }
        .input-field {
            @apply w-full px-4 py-2 text-gray-700 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200;
        }
        .label-text {
            @apply block text-sm font-medium text-gray-600 mb-1;
        }
        .radio-group {
            @apply flex items-center gap-x-4;
        }
        .radio-label {
            @apply flex items-center text-sm text-gray-700;
        }
        .radio-input {
            @apply h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500;
        }
        .form-grid {
            @apply grid grid-cols-1 md:grid-cols-2 gap-6;
        }
        .dynamic-item .remove-btn { 
            display: none; 
        }
        .dynamic-item:hover .remove-btn {
            display: block; 
        }
        @media print {
            body { background: #fff; }
            #navigation-controls, #progress-bar, #header, #footer { display: none !important; }
            .printable-only { display: block !important; }
            .print-button { display: none !important; }
            .no-print { display: none !important; }
        }
        .printable-only {
            display: none;
        }
        #submit-btn {
            background-color: #dc2626; /* red-600 */
        }
        #submit-btn:hover {
            background-color: #b91c1c; /* red-700 */
        }
        /* New styles for the printable summary */
        .printable-page {
            box-sizing: border-box;
            width: 8.5in;
            height: 11in;
            padding: 0.75in;
            margin: 0.5in auto;
            background: #fff;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .printable-field {
            border-bottom: 1px solid #000;
            padding-bottom: 2px;
            font-size: 0.9rem;
            margin-top: 1rem;
        }
        .printable-label {
            display: block;
            font-size: 0.75rem;
            color: #444;
            text-transform: uppercase;
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div class="container mx-auto px-4 py-8 md:py-12 no-print">
        <header id="header" class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Haron Enterprises, LLC</h1>
            <p class="mt-2 text-lg text-gray-600">Residential Lease Application</p>
            <p class="text-sm text-gray-500">Eff date 09 30 25 v32.0 new Haron 14  G doc  4dump </p>
        </header>
        <div id="application-wizard" class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
            <div id="progress-bar" class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <!-- Progress steps will be dynamically added by JavaScript -->
                </div>
            </div>

            <form id="rental-application-form" class="p-6 md:p-8">
                <div id="status-message" class="text-sm px-4 py-2 rounded-md mb-4 hidden" role="alert"></div>
                
               <section id="section-1" class="form-section active">
    <h2 class="text-2xl font-semibold mb-2 text-gray-800">APPLICANT & CO-APPLICANT DATA (Page 1)</h2>
    <p class="text-gray-600 mb-6">Complete all fields. Please note the co-applicant section is optional.</p>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="p-4 border border-blue-200 rounded-lg bg-blue-50">
            <h3 class="font-bold text-lg mb-4 text-blue-700">Applicant Details</h3>
            
            <div class="space-y-4">
                <label class="label-text">Full Name</label><input type="text" name="Applicant Full Name" class="input-field">
                <label class="label-text">Date of Birth</label><input type="date" name="Applicant Date of Birth" class="input-field">
                <label class="label-text">Social Security Number</label><input type="text" name="Applicant SSN" class="input-field">
                <label class="label-text">Driver's License #/State</label><input type="text" name="Applicant DL #" class="input-field">
                <label class="label-text">Phone</label><input type="tel" name="Applicant Phone" class="input-field">
                <label class="label-text">Email Address</label><input type="email" name="Applicant Email" class="input-field">
                <label class="label-text">Relationship to Co-Applicant</label><input type="text" name="Applicant Relation to Co-Applicant" class="input-field">
                <label class="label-text">Current Employer</label><input type="text" name="Applicant Current Employer" class="input-field">
                <label class="label-text">Monthly Income (Gross)</label><input type="number" name="Applicant Monthly Income" class="input-field">
                <label class="label-text">Marital Status</label><input type="text" name="Applicant Marital Status" class="input-field">
                <label class="label-text">Emergency Contact Name</label><input type="text" name="Applicant Emergency Contact Name" class="input-field">
                <label class="label-text">Emergency Contact Phone</label><input type="tel" name="Applicant Emergency Contact Phone" class="input-field">
                <label class="label-text">Are you a U.S. Citizen?</label><select name="Applicant Citizen Status" class="input-field"><option>Yes</option><option>No</option></select>
            </div>
        </div>

        <div class="p-4 border border-gray-200 rounded-lg bg-gray-50">
            <h3 class="font-bold text-lg mb-4 text-gray-700">Co-Applicant Details (Optional)</h3>
            
            <div class="space-y-4">
                <label class="label-text">Full Name</label><input type="text" name="Co-Applicant Full Name" class="input-field">
                <label class="label-text">Date of Birth</label><input type="date" name="Co-Applicant Date of Birth" class="input-field">
                <label class="label-text">Social Security Number</label><input type="text" name="Co-Applicant SSN" class="input-field">
                <label class="label-text">Driver's License #/State</label><input type="text" name="Co-Applicant DL #" class="input-field">
                <label class="label-text">Phone</label><input type="tel" name="Co-Applicant Phone" class="input-field">
                <label class="label-text">Email Address</label><input type="email" name="Co-Applicant Email" class="input-field">
                <label class="label-text">Relationship to Applicant</label><input type="text" name="Co-Applicant Relation to Applicant" class="input-field">
                <label class="label-text">Current Employer</label><input type="text" name="Co-Applicant Current Employer" class="input-field">
                <label class="label-text">Monthly Income (Gross)</label><input type="number" name="Co-Applicant Monthly Income" class="input-field">
                <label class="label-text">Marital Status</label><input type="text" name="Co-Applicant Marital Status" class="input-field">
                <label class="label-text">Emergency Contact Name</label><input type="text" name="Co-Applicant Emergency Contact Name" class="input-field">
                <label class="label-text">Emergency Contact Phone</label><input type="tel" name="Co-Applicant Emergency Contact Phone" class="input-field">
                <label class="label-text">Are you a U.S. Citizen?</label><select name="Co-Applicant Citizen Status" class="input-field"><option>Yes</option><option>No</option></select>
            </div>
        </div>
    </div>

    <div class="mt-8 border-t border-gray-300 pt-6">
        <h3 class="text-xl font-bold mb-4 text-gray-800">Rental History (4 Year Minimum Required)</h3>
        <div id="rental-history-container" class="space-y-4">
            <div class="p-4 border border-yellow-300 bg-yellow-50 rounded-lg dynamic-item" data-rent-start-date="rental-start-1" data-rent-end-date="rental-end-1">
                <h4 class="font-semibold mb-2">Residence 1 (Required)</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div><label class="label-text">Address</label><input type="text" name="Residence 1 Address" class="input-field" required></div>
                    <div><label class="label-text">Landlord/Manager Name</label><input type="text" name="Residence 1 Landlord Name" class="input-field" required></div>
                    <div><label class="label-text">Landlord Phone</label><input type="tel" name="Residence 1 Landlord Phone" class="input-field"></div>
                    <div><label class="label-text">Monthly Rent</label><input type="number" name="Residence 1 Monthly Rent" class="input-field" required></div>
                    <div><label class="label-text">Start Date</label><input type="date" id="rental-start-1" name="Residence 1 Start Date" class="input-field rent-start" required></div>
                    <div><label class="label-text">End Date</label><input type="date" id="rental-end-1" name="Residence 1 End Date" class="input-field rent-end" required></div>
                    <div class="md:col-span-3"><label class="label-text">Reason for Leaving</label><input type="text" name="Residence 1 Reason for Leaving" class="input-field"></div>
                </div>
            </div>
        </div>
        <button type="button" id="add-rental-btn" class="mt-4 btn-secondary text-sm px-3 py-1">Add Previous Residence</button>
        <p id="rental-history-message" class="mt-2 text-sm font-semibold text-red-600 hidden">Required: Total residency must cover a minimum of 4 years. Please add more addresses.</p>
    </div>

    <div class="mt-8 border-t border-gray-300 pt-6">
        <h3 class="text-xl font-bold mb-4 text-gray-800">Other Household Members (Not Applicant/Co-Applicant)</h3>
        <div id="other-members-container" class="space-y-4">
            </div>
        <button type="button" id="add-member-btn" class="mt-4 btn-secondary text-sm px-3 py-1">Add Household Member</button>
    </div>
</section>
                <section id="section-3" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Background & History</h2>
                    <p class="text-gray-600 mb-6">This section covers your rental and financial history. Please answer all questions honestly, as this information is used for standard background verification. Answering "yes" does not necessarily disqualify you.</p>
                    <div class="space-y-6">
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever been evicted?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Evicted" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'evicted-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Evicted" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'evicted-explain', true)" checked>No</label>
                            </div>
                            <div id="evicted-explain" class="hidden mt-2"><label class="label-text">Please explain:</label><textarea class="input-field" name="Evicted Explanation" rows="2"></textarea></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever been foreclosed on?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Foreclosed" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'foreclosed-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Foreclosed" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'foreclosed-explain', true)" checked>No</label>
                            </div>
                            <div id="foreclosed-explain" class="hidden mt-2"><label class="label-text">Please explain:</label><textarea class="input-field" name="Foreclosed Explanation" rows="2"></textarea></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever filed for bankruptcy?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Filed for Bankruptcy" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'bankruptcy-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Filed for Bankruptcy" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'bankruptcy-explain', true)" checked>No</label>
                            </div>
                             <div id="bankruptcy-explain" class="hidden mt-2"><label class="label-text">If yes, explain:</label><textarea class="input-field" name="Bankruptcy Explanation" rows="2"></textarea></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever been charged with a felony?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Charged with a Felony" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'felony-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Charged with a Felony" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'felony-explain', true)" checked>No</label>
                            </div>
                             <div id="felony-explain" class="hidden mt-2"><label class="label-text">If yes, explain:</label><textarea class="input-field" name="Felony Explanation" rows="2"></textarea></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever broken a lease or refused to pay rent?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Broken Lease" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'brokenLease-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Broken Lease" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'brokenLease-explain', true)" checked>No</label>
                            </div>
                             <div id="brokenLease-explain" class="hidden mt-2"><label class="label-text">If yes, explain:</label><textarea class="input-field" name="Broken Lease Explanation" rows="2"></textarea></div>
                        </div>
                    </div>
                </section>

                <section id="section-4" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Financial & Employment Information</h2>
                     <p class="text-gray-600 mb-6">This section helps us verify your household's financial stability and ability to meet rent obligations. Please provide details on employment, income, assets, and liabilities for all adult household members.</p>

                    <div class="mt-6">
                        <h3 class="text-lg font-semibold text-gray-700">Employment History (4 years minimum)</h3>
                        <div id="employment-container" class="mt-4 space-y-6"></div>
                        <button type="button" id="add-employment-btn" class="mt-4 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Employment</button>
                    </div>

                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-gray-700">Other Income Sources</h3>
                        <div id="income-container" class="mt-4 space-y-4"></div>
                        <button type="button" id="add-income-btn" class="mt-4 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Income Source</button>
                    </div>

                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-gray-700">Assets</h3>
                        <div id="assets-container" class="mt-4 space-y-4"></div>
                        <button type="button" id="add-asset-btn" class="mt-4 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Asset</button>
                    </div>

                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-gray-700">Liabilities</h3>
                        <div id="liabilities-container" class="mt-4 space-y-4"></div>
                        <button type="button" id="add-liability-btn" class="mt-4 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Liability</button>
                    </div>
                </section>

                <section id="section-5" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Required Documents</h2>
                    <p class="text-gray-600 mb-6">To complete the verification process, we need you to upload several documents. You can upload multiple files for each category if needed. This is a crucial step for a complete application.</p>
                    <div class="space-y-4">
                        <div class="document-upload-item"><label class="label-text">Photo ID for all adult household members</label><input type="file" name="file_PhotoID[]" class="input-field" multiple></div>
                        <div class="document-upload-item"><label class="label-text">Social Security Cards for all household members</label><input type="file" name="file_SocialSecurityCards[]" class="input-field" multiple></div>
                        <div class="document-upload-item"><label class="label-text">Birth certificates for household members under 18</label><input type="file" name="file_BirthCertificates[]" class="input-field" multiple></div>
                        <div class="document-upload-item"><label class="label-text">Six (6) most current pay stubs</label><input type="file" name="file_PayStubs[]" class="input-field" multiple></div>
                        <div class="document-upload-item"><label class="label-text">Proof of last six (6) months rent/mortgage payments</label><input type="file" name="file_RentMortgageProof[]" class="input-field" multiple></div>
                        <div class="document-upload-item"><label class="label-text">Self-Employed: Last year's tax return & 3 months income reports</label><input type="file" name="file_SelfEmployedDocs[]" class="input-field" multiple></div>
                        <div class="document-upload-item"><label class="label-text">Notarized statement for adult household members with no income</label><input type="file" name="file_NoIncomeStatement[]" class="input-field" multiple></div>
                        <div class="document-upload-item"><label class="label-text">Letter from employer(s)</label><input type="file" name="file_EmployerLetter[]" class="input-field" multiple></div>
                        <div class="document-upload-item"><label class="label-text">Last six (6) months of bank statements</label><input type="file" name="file_BankStatements[]" class="input-field" multiple></div>
                        <div class="document-upload-item"><label class="label-text">Photos of any animals that will be living on the premises</label><input type="file" name="file_AnimalPhotos[]" class="input-field" multiple></div>
                    </div>
                </section>

                <section id="section-6" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Authorizations & Agreement</h2>
                    <p class="text-gray-600 mb-6">You're almost done! Please read the following legal statements carefully. Your agreement is required to finalize and submit your application for review.</p>
                    <div class="prose prose-sm max-w-none text-gray-600 bg-gray-50 p-4 rounded-md border border-gray-200">
                        <p><strong>Text:</strong> I/We understand that Florida Statute 817 provides that a person is guilty of a misdemeanor in the first degree who knowingly makes a false statement in writing with the intent to mislead a landlord in repairing or leasing a dwelling unit. I CERTIFY THAT ALL THE INFORMATION PROVIDED IN THIS APPLICATION IS TRUE AND CORRECT. I, the undersigned applicant, affirm the information above is true and complete and authorize Haron Enterprises, LLC to make any and all inquiries necessary to verify said information, including but not limited to, direct contact with any person, business, or agency named above. I also understand that any false information on this application may cause this application to be rejected and may be grounds for immediate termination of the lease at the owner's option. I also agree to all the terms and conditions in the rental agreement, should this application be accepted.</p>
                    </div>
                    <div class="mt-6">
                        <label class="flex items-center">
                            <input type="checkbox" id="agree-terms" name="agreement" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500" required>
                            <span class="ml-3 text-gray-700">By checking this box, you attest that all information provided is true and accurate, and you agree to the terms and authorizations.</span>
                        </label>
                    </div>
                     <div class="mt-8 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg">
                        <h3 class="font-semibold text-blue-800">Final Step: Application Fee</h3>
                        <p class="text-sm text-blue-700 mt-1">A non-refundable processing fee of $50.00 is required. This fee must be paid prior to an application being accepted or processed. Upon submitting, you will be contacted with payment instructions.</p>
                    </div>
                  
                </section>
                     <div class="flex justify-between mt-8">
                          <button type="button" id="prev-btn" class="btn-secondary">Previous</button>      
                          <div id="spacer"></div>
                         <button type="button" id="next-btn" class="btn-primary">Next</button>
                         <button type="submit" id="submit-btn" class="btn-primary" style="display: none;">Submit Application</button>
                     </div>
              </form>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // v32.0: Restructured Screen 1 HTML and implemented 4-year rental history validation.
        let currentStep = 1;
        const totalSteps = 6; 
        const form = document.getElementById('rental-application-form');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const spacer = document.getElementById('spacer');

        // --- Core Navigation Functions ---
        
        const updateButtons = () => {
            prevBtn.style.display = currentStep > 1 ? 'block' : 'none';
            spacer.style.display = currentStep === 1 ? 'block' : 'none';
            nextBtn.style.display = currentStep < totalSteps ? 'block' : 'none';
            submitBtn.style.display = currentStep === totalSteps ? 'block' : 'none';
        };

        const showSection = (step) => {
            document.querySelectorAll('.form-section').forEach(section => section.classList.remove('active'));
            document.getElementById(`section-${step}`).classList.add('active');
        };

        const calculateDateDifferenceInYears = (startDate, endDate) => {
            if (!startDate || !endDate) return 0;
            const start = new Date(startDate);
            const end = new Date(endDate);
            if (end < start) return 0;
            
            const diffTime = Math.abs(end - start);
            // Convert milliseconds to years (average 365.25 days per year)
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays / 365.25;
        };

        // --- NEW: Rental History Validation Function ---
        const validateRentalHistory = () => {
            const rentalItems = document.querySelectorAll('#rental-history-container .dynamic-item');
            let totalYears = 0;
            let isValid = true;

            rentalItems.forEach(item => {
                const startDateInput = item.querySelector('.rent-start');
                const endDateInput = item.querySelector('.rent-end');

                if (startDateInput.value && endDateInput.value) {
                    totalYears += calculateDateDifferenceInYears(startDateInput.value, endDateInput.value);
                }
            });

            const messageElement = document.getElementById('rental-history-message');
            
            // 4 years * 365.25 days = 1461 days (totalYears is already in years)
            if (totalYears < 4) {
                messageElement.textContent = `Required: Total residency must cover a minimum of 4 years. Currently: ${totalYears.toFixed(2)} years. Please add more addresses.`;
                messageElement.classList.remove('hidden');
                isValid = false;
            } else {
                messageElement.classList.add('hidden');
            }
            return isValid;
        };
        // ---------------------------------------------
        
        // --- Event Listeners ---

        nextBtn.addEventListener('click', (e) => {
            e.preventDefault();
            const currentSection = document.getElementById(`section-${currentStep}`);
            const requiredInputs = currentSection.querySelectorAll('[required]');
            let formIsValid = true;

            // 1. Standard HTML Validation
            requiredInputs.forEach(input => {
                if (!input.checkValidity()) {
                    formIsValid = false;
                    input.reportValidity();
                }
            });

            // 2. Custom Logic for Screen 1
            if (currentStep === 1) {
                const rentalIsValid = validateRentalHistory();
                if (!rentalIsValid) {
                    formIsValid = false;
                }
            }

            if (formIsValid) {
                if (currentStep < totalSteps) {
                    currentStep++;
                    showSection(currentStep);
                    updateButtons();
                    // updateProgressBar(); // Assuming this function is still in your full script
                    window.scrollTo(0, 0);
                }
            }
        });

        prevBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (currentStep > 1) {
                currentStep--;
                showSection(currentStep);
                updateButtons();
                // updateProgressBar(); // Assuming this function is still in your full script
                window.scrollTo(0, 0);
            }
        });

        // --- Dynamic Block Helpers ---

        // General dynamic block creator for easy HTML insertion
        const createDynamicBlock = (containerId, innerHTML) => {
            const container = document.getElementById(containerId);
            const count = container.querySelectorAll('.dynamic-item').length + 1;
            const newBlock = document.createElement('div');
            newBlock.className = 'p-4 border border-gray-200 rounded-lg relative dynamic-item';
            newBlock.innerHTML = innerHTML(count);
            container.appendChild(newBlock);
        };

        // Household Member (Page 1 - Other Members)
        document.getElementById('add-member-btn')?.addEventListener('click', () => {
            createDynamicBlock('other-members-container', (count) => `
                <button type="button" class="absolute top-2 right-2 text-red-500 hover:text-red-700 remove-btn" onclick="this.parentElement.remove()">&#x2715;</button>
                <h4 class="font-semibold mb-2">Household Member ${count}</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div><label class="label-text">Full Name</label><input type="text" name="Other Member ${count} Full Name" class="input-field"></div>
                    <div><label class="label-text">Date of Birth</label><input type="date" name="Other Member ${count} DOB" class="input-field"></div>
                    <div><label class="label-text">Relationship to Applicant</label><input type="text" name="Other Member ${count} Relationship" class="input-field"></div>
                </div>
            `);
        });

        // Rental History (Page 1)
        document.getElementById('add-rental-btn')?.addEventListener('click', () => {
            const count = document.querySelectorAll('#rental-history-container .dynamic-item').length + 1;
            createDynamicBlock('rental-history-container', (count) => `
                <button type="button" class="absolute top-2 right-2 text-red-500 hover:text-red-700 remove-btn" onclick="this.parentElement.remove()">&#x2715;</button>
                <h4 class="font-semibold mb-2">Residence ${count}</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div><label class="label-text">Address</label><input type="text" name="Residence ${count} Address" class="input-field" required></div>
                    <div><label class="label-text">Landlord/Manager Name</label><input type="text" name="Residence ${count} Landlord Name" class="input-field" required></div>
                    <div><label class="label-text">Landlord Phone</label><input type="tel" name="Residence ${count} Landlord Phone" class="input-field"></div>
                    <div><label class="label-text">Monthly Rent</label><input type="number" name="Residence ${count} Monthly Rent" class="input-field" required></div>
                    <div><label class="label-text">Start Date</label><input type="date" id="rental-start-${count}" name="Residence ${count} Start Date" class="input-field rent-start" required></div>
                    <div><label class="label-text">End Date</label><input type="date" id="rental-end-${count}" name="Residence ${count} End Date" class="input-field rent-end" required></div>
                    <div class="md:col-span-3"><label class="label-text">Reason for Leaving</label><input type="text" name="Residence ${count} Reason for Leaving" class="input-field"></div>
                </div>
            `);
        });

        // Re-validate rental history whenever dates change on Screen 1
        document.getElementById('rental-history-container')?.addEventListener('change', (e) => {
            if (e.target.classList.contains('rent-start') || e.target.classList.contains('rent-end')) {
                validateRentalHistory();
            }
        });

        // --- Final Print Template Logic (Simplified for reliability) ---

        const generateFinalPrintHtml = (formData) => {
            
            // Revert back to the simple, reliable summary template to ensure data capture.
            const dataMap = {};
            let rawDataOutput = "--- RAW FORM DATA DUMP ---\n\n";

            for (const [key, value] of formData.entries()) {
                const cleanedKey = key.trim();
                dataMap[cleanedKey] = value;
                rawDataOutput += `KEY: ${cleanedKey}\nVALUE: ${value}\n\n`;
            }

            const getVal = (key) => dataMap[key] || '____________________';

            // Function to generate dynamic groups (simplified for v32.0 structure)
            const generateDynamicSection = (data, prefix, fields) => {
                let html = '';
                let groups = {};

                // Group fields by their index (e.g., '1', '2')
                for (const key in data) {
                    if (key.startsWith(prefix)) {
                        const parts = key.split(' ');
                        const numberIndex = parts.find(p => !isNaN(parseInt(p)) && p.length > 0);
                        const fieldName = (numberIndex) ? parts.slice(parts.indexOf(numberIndex) + 1).join(' ') : parts.slice(prefix.split(' ').length).join(' ');

                        if (numberIndex) {
                            if (!groups[numberIndex]) groups[numberIndex] = {};
                            groups[numberIndex][fieldName] = data[key];
                        }
                    }
                }

                for (const index in groups) {
                    html += `<div class="dynamic-group"><h3>${prefix} ${index}</h3>`;
                    for (const field of fields) {
                        const val = groups[index][field] || ''; 
                        html += `<div class="data-row"><span class="data-label">${field}:</span> <span class="data-value">${val ? val : '____________________'}</span></div>`;
                    }
                    html += `</div>`;
                }
                return html || '<p class="note">No items were entered for this section.</p>';
            };

            // --- HTML TEMPLATE START ---
            let finalHtml = `
            <html>
            <head>
                <title>Print Application</title>
                <style>
                    body { font-family: Arial, sans-serif; font-size: 11pt; line-height: 1.5; padding: 0.5in; margin: 0; }
                    h1 { font-size: 18pt; text-align: center; margin-bottom: 25px; border-bottom: 2px solid #000; padding-bottom: 10px; }
                    h2 { font-size: 14pt; margin-top: 30px; margin-bottom: 10px; color: #1e3a8a; border-bottom: 1px solid #000; padding-bottom: 5px; }
                    .data-row { margin-bottom: 5px; }
                    .data-label { font-weight: bold; width: 250px; display: inline-block; }
                    .data-value { color: #a00; font-weight: bold; }
                    .dynamic-group { margin: 10px 0 15px 0; padding: 10px; border: 1px solid #ccc; border-radius: 5px; page-break-inside: avoid; }
                    .data-dump { font-size: 9pt; background: #f4f4f4; padding: 10px; border: 1px dashed #aaa; white-space: pre-wrap; word-wrap: break-word; }
                    .print-page-break { page-break-before: always; height: 1px; display: block; } 
                </style>
            </head>
            <body>
                <div id="print-content">
                <h1>HARON15 ENTERPRISES, LLC - APPLICATION RESTRUCTURE</h1>

                <h2 style="color: red; border-bottom: 2px solid red;">FOR AGENT USE ONLY: RAW DATA DIAGNOSTIC</h2>
                <div class="data-dump">${rawDataOutput}</div>
                
                <div class="print-page-break"></div>

                <h2>APPLICANT & CO-APPLICANT DATA</h2>
                <div style="display: flex; justify-content: space-between; gap: 20px;">
                    <div style="flex: 1;">
                        <h3>Applicant:</h3>
                        <div class="data-row"><span class="data-label">Full Name:</span> <span class="data-value">${getVal('Applicant Full Name')}</span></div>
                        <div class="data-row"><span class="data-label">SSN:</span> <span class="data-value">${getVal('Applicant SSN')}</span></div>
                        <div class="data-row"><span class="data-label">Email:</span> <span class="data-value">${getVal('Applicant Email')}</span></div>
                        <div class="data-row"><span class="data-label">Current Employer:</span> <span class="data-value">${getVal('Applicant Current Employer')}</span></div>
                    </div>
                    <div style="flex: 1;">
                        <h3>Co-Applicant:</h3>
                        <div class="data-row"><span class="data-label">Full Name:</span> <span class="data-value">${getVal('Co-Applicant Full Name')}</span></div>
                        <div class="data-row"><span class="data-label">SSN:</span> <span class="data-value">${getVal('Co-Applicant SSN')}</span></div>
                        <div class="data-row"><span class="data-label">Email:</span> <span class="data-value">${getVal('Co-Applicant Email')}</span></div>
                        <div class="data-row"><span class="data-label">Current Employer:</span> <span class="data-value">${getVal('Co-Applicant Current Employer')}</span></div>
                    </div>
                </div>
                
                <h2>RENTAL HISTORY (4 Year Minimum)</h2>
                ${generateDynamicSection(dataMap, 'Residence', ['Address', 'Landlord Name', 'Start Date', 'End Date', 'Monthly Rent'])}

                <h2>OTHER HOUSEHOLD MEMBERS</h2>
                ${generateDynamicSection(dataMap, 'Other Member', ['Full Name', 'DOB', 'Relationship'])}
                
                </div>
            </body>
            </html>
            `;
            // --- HTML TEMPLATE END ---

            return finalHtml;
        };


        // START: CODE FOR FORM SUBMISSION AND PRINTING
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const agreeCheckbox = document.getElementById('agree-terms');
            if (agreeCheckbox && !agreeCheckbox.checkValidity()) {
                agreeCheckbox.reportValidity();
                return;
            }
            
            const printHtml = generateFinalPrintHtml(new FormData(form));
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printHtml);
            printWindow.document.close();

            printWindow.onload = () => {
                printWindow.print();
            };
        });
        // END: CODE FOR FORM SUBMISSION AND PRINTING

        // Initial setup
        showSection(1);
        updateButtons();
    });

    function toggleExplain(radio, divId, showOnYes) {
        // Retaining this function...
    }
</script>
  </body>
</html>
