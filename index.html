<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haron Enterprises, LLC - Residential Lease Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Professional Neutral -->
    <!-- Application Structure Plan: The multi-step wizard breaks down the application. The final action is client-side PDF generation, which is the most reliable method without a server. -->
    <!-- Visualization & Content Choices: Uses a printable summary page generated by JavaScript after submission, allowing the user to save a professional, auditable PDF. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            background-color: #f8f7f4; 
            font-family: 'Inter', sans-serif;
        }
        @import url('https://rsms.me/inter/inter.css');
        .form-section {
            display: none;
        }
        .form-section.active {
            display: block;
        }
        .step-item-active {
            border-color: #3b82f6;
            color: #3b82f6;
        }
        .step-item-complete {
            border-color: #16a34a;
            color: #16a34a;
            background-color: #f0fdf4;
        }
        .input-field {
            @apply w-full px-4 py-2 text-gray-700 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200;
        }
        .label-text {
            @apply block text-sm font-medium text-gray-600 mb-1;
        }
        .radio-group {
            @apply flex items-center gap-x-4;
        }
        .radio-label {
            @apply flex items-center text-sm text-gray-700;
        }
        .radio-input {
            @apply h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500;
        }
        .form-grid {
            @apply grid grid-cols-1 md:grid-cols-2 gap-6;
        }
        /* START: FIX for Red X on dynamic items */
        .dynamic-item .remove-btn { 
            display: none; 
        }
        .dynamic-item:hover .remove-btn {
            display: block; 
        }
        /* END: FIX for Red X on dynamic items */
        @media print {
            body { background: #fff; }
            #navigation-controls, #progress-bar, #header, #footer, #application-wizard { display: none !important; }
            .printable-only { display: block !important; }
            .print-button { display: none !important; }
            .no-print { display: none !important; }
        }
        .printable-only {
            display: none;
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div class="container mx-auto px-4 py-8 md:py-12 no-print">
        <header id="header" class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Haron Enterprises, LLC</h1>
            <p class="mt-2 text-lg text-gray-600">Residential Lease Application</p>
            <!-- START: Header completion -->
            <p class="text-sm text-gray-600 font-semibold">In Accordance with Seminole County NSP Rentals Program</p>
            <p class="text-sm text-red-600 font-bold">AII INCOMPLETE applications will be REJECTED. Tel: (407) 702-3281 / Fax: (866) 858-5371</p>
            <p class="text-sm text-gray-500">Eff date 09 18 25 v47.3</p>
            <!-- END: Header completion -->
        </header>

        <div id="application-wizard" class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
            <div id="progress-bar" class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <div id="step-1" class="step-item step-item-active text-center w-1/6">
                        <div class="border-b-4 pb-2 text-xs md:text-sm font-semibold">Checklist</div>
                    </div>
                     <div id="step-2" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">Address</div>
                    </div>
                     <div id="step-3" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">Household</div>
                    </div>
                     <div id="step-4" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">Financial</div>
                    </div>
                     <div id="step-5" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">History</div>
                    </div>
                    <div id="step-6" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">Final</div>
                    </div>
                </div>
            </div>

            <!-- CRITICAL FIX: Removed action attribute entirely for self-contained operation -->
            <form id="rental-application-form" class="p-6 md:p-8">
                <div id="status-message" class="text-sm px-4 py-2 rounded-md mb-4 hidden" role="alert"></div>
                
                <!-- START: SECTION 1 (Intro/Checklist) - Simple Layout -->
                <section id="section-1" class="form-section active">
                    <h2 class="text-2xl font-semibold mb-3 text-gray-800">APPLICATION CHECKLIST</h2>
                    <p class="text-gray-600 mb-6 border-b pb-4">Please review and confirm the initial requirements and provide your basic identification details to begin the application process.</p>
                    
                    <!-- START: FIX for layout to be single column flow -->
                    <div class="space-y-6">
                        
                        <div class="border p-4 rounded-lg bg-gray-50">
                            <h3 class="text-lg font-semibold mb-3 text-gray-700 border-b pb-1">Basic Identification</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label class="label-text" for="fullName">Full Name</label><input type="text" id="fullName" name="Full Name" class="input-field" required></div>
                                <div><label class="label-text" for="dob">Date of Birth</label><input type="date" id="dob" name="Date of Birth" class="input-field" required></div>
                            </div>
                        </div>

                        <!-- Checkboxes now flowed below -->
                        <div>
                            <h3 class="text-lg font-semibold mb-3 text-gray-700 border-b pb-1">Required Documentation Checklist</h3>
                            <p class="text-sm text-gray-600 mb-4">For any item on the checklist that does not apply, please mark N/A. For any page that does not apply, please mark N/A across the page. This shows our office that you have reviewed the item and that it does not apply to your household. Please use this checklist to make sure you have all the documentation needed to complete your application.</p>
                            <div class="space-y-2">
                                <!-- All 18 checkboxes from the original document with EXACT wording -->
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_IncomeQualified" class="radio-input mr-2" required>I/We understand that this property is owned by a private company and subject to Maximum Income Qualification as established by HUD & Seminole County's Neighborhood Stabilization Program (NSP) requirements.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_IncomeRatio" class="radio-input mr-2" required>Our Household Income is at least 3 times the monthly Rent amount.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_AdultSignatures" class="radio-input mr-2" required>All adult household members (18 years of age or older) must sign page 6 of the application.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_PhotoID" class="radio-input mr-2" required>Attach: Copies of photo Identification for all adult household members.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_SocialSecurityCards" class="radio-input mr-2" required>Attach: Copies of Social Security Cards for all household members.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_BirthCertificates" class="radio-input mr-2" required>Copies of birth certificates for all household members under the age of 18 are required.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_PayStubs" class="radio-input mr-2" required>Attach: SIX (6) most current pay check stubs for all household members who are working now.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_RentProof" class="radio-input mr-2" required>Attach: Proof of last SIX (6) month's rent or mortgage payments.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_SelfEmployedTax" class="radio-input mr-2" required>Attach: If Self-Employed, please provide a signed copy of last year's tax return.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_IncomeExpenseReports" class="radio-input mr-2" required>Attach: If Self-Employed, provide three months of income/expense reports.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_NoIncomeStatement" class="radio-input mr-2" required>Attach: Notarized statement for adult household members with no income.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_EmployerLetter" class="radio-input mr-2" required>Attach: Letter from employer(s).</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_BankStatements" class="radio-input mr-2" required>Attach: Last six (6) months of bank statements.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_AssetsLiabilities" class="radio-input mr-2" required>Attach: Documentation for all Assets and Liabilities.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_CreditReport" class="radio-input mr-2" required>Attach: Copy of credit report for all adults.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_CriminalCheck" class="radio-input mr-2" required>Attach: Criminal background check for all adults.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_ApplicationFee" class="radio-input mr-2" required>Attach: Proof of $50 non-refundable application fee payment.</label>
                                <label class="flex items-center text-sm text-gray-700"><input type="checkbox" name="Checklist_AnimalPhotos" class="radio-input mr-2" required>Attach: Photos of any animals that will be living on the premises.</label>
                            </div>
                        </div>
                    </div>
                    <!-- END: FIX for layout to be single column flow -->
                </section>
                <!-- END: SECTION 1 (Intro/Checklist) -->

                <!-- START: SECTION 2 (Address/Rental History - 3 Column Layout) -->
                <section id="section-2" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Detailed Applicant & Rental History</h2>
                    <p class="text-gray-600 mb-6">Complete all identification, contact, and address fields below. Rental history must cover the last five years.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        
                        <!-- Column 1: Description/Instructions -->
                        <div class="md:col-span-1 space-y-4 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                            <h3 class="text-lg font-semibold text-gray-700 border-b pb-1">Identification & Vehicle</h3>
                            <div><label class="label-text" for="ssn">Social Security Number</label><input type="text" id="ssn" name="Social Security Number" class="input-field" required></div>
                            <div><label class="label-text" for="dl">Driver's License #</label><input type="text" id="dl" name="Driver's License #" class="input-field" required></div>
                            <div><label class="label-text" for="vehicleMake">Vehicle Make & Model</label><input type="text" id="vehicleMake" name="Vehicle Make & Model" class="input-field"></div>
                            <div><label class="label-text" for="vehicleTag">Vehicle Tag #</label><input type="text" id="vehicleTag" name="Vehicle Tag #" class="input-field"></div>
                            <div class="space-y-2 pt-2">
                                <span class="label-text">Armed Services Member?</span>
                                <div class="radio-group">
                                    <label class="radio-label"><input type="radio" name="Armed Services Member" value="yes" class="radio-input mr-2">Yes</label>
                                    <label class="radio-label"><input type="radio" name="Armed Services Member" value="no" class="radio-input mr-2" checked>No</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Column 2: Current Address & Landlord -->
                        <div class="md:col-span-1 space-y-4">
                            <h3 class="text-lg font-semibold mb-2 text-gray-800 border-b pb-1">Current Residence Details</h3>
                            <div><label class="label-text" for="currentStreet">Street Address</label><input type="text" id="currentStreet" name="Current Street Address" class="input-field" required></div>
                            <div><label class="label-text" for="currentCity">City</label><input type="text" id="currentCity" name="Current City" class="input-field" required></div>
                            <div><label class="label-text" for="currentState">State</label><input type="text" id="currentState" name="Current State" class="input-field" required></div>
                            <div><label class="label-text" for="currentZip">Zip Code</label><input type="text" id="currentZip" name="Current Zip Code" class="input-field" required></div>
                            <div><label class="label-text" for="timeAtCurrent">Time at Current Residence</label><input type="text" id="timeAtCurrent" name="Time at Current Residence" class="input-field" required></div>
                            <div><label class="label-text" for="currentLandlord">Current Landlord/Mortgage Co.</label><input type="text" id="currentLandlord" name="Current Landlord/Mortgage Co." class="input-field" required></div>
                            <div><label class="label-text" for="currentLandlordPhone">Landlord Phone</label><input type="tel" id="currentLandlordPhone" name="Current Landlord Phone" class="input-field" required></div>
                        </div>

                        <!-- Column 3: Previous Address (Dynamic Block) -->
                         <div class="md:col-span-1 space-y-4">
                            <h3 class="text-lg font-semibold mb-2 text-gray-800 border-b pb-1">Previous Residence History</h3>
                             <div id="prev-address-container" class="space-y-4"></div>
                            <button type="button" id="add-prev-address-btn" class="mt-2 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Previous Residence</button>
                        </div>
                    </div>
                </section>
                <!-- END: SECTION 2 (Address/Rental History - 3 Column Layout) -->


                <!-- START: SECTION 3 (Household Members & Citizenship) -->
                <section id="section-3" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Household & Citizenship Details</h2>
                    <p class="text-gray-600 mb-6">List all other household members. This information is vital for income and program qualification.</p>
                    
                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-gray-700">Other Household Members</h3>
                        <p class="text-sm text-gray-600 mb-4">Please list everyone who will be living in the unit, besides the applicant(s).</p>
                        <div id="household-members-container" class="mt-4 space-y-4"></div>
                        <button type="button" id="add-member-btn" class="mt-4 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Household Member</button>
                    </div>
                    
                    <div class="mt-8 space-y-6">
                        <div>
                            <span class="label-text">Are ALL members of the household U.S. Citizens?</span>
                             <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="US Citizens" value="yes" class="radio-input mr-2" checked onclick="toggleExplain(this, 'citizen-explain', false)">Yes</label>
                                <label class="radio-label"><input type="radio" name="US Citizens" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'citizen-explain', false)">No</label>
                            </div>
                             <div id="citizen-explain" class="hidden mt-2"><label class="label-text" for="citizen_explain_text">If no, please explain:</label><textarea class="input-field" id="citizen_explain_text" name="US Citizens Explanation" rows="2"></textarea></div>
                        </div>
                         <div>
                            <span class="label-text">Is any household member (age 18+) a full-time student?</span>
                             <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Full-Time Student" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'student-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Full-Time Student" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'student-explain', true)" checked>No</label>
                            </div>
                             <div id="student-explain" class="hidden mt-2"><label class="label-text" for="student_explain_text">If yes, please list and attach school enrollment printout:</label><textarea class="input-field" id="student_explain_text" name="Student Explanation" rows="2"></textarea></div>
                        </div>
                        <div><label class="label-text" for="relativeName">Name of Nearest Relative</label><input type="text" id="relativeName" name="Name of Nearest Relative" class="input-field" required></div>
                        <div><label class="label-text" for="relativePhone">Phone of Nearest Relative</label><input type="tel" id="relativePhone" name="Phone of Nearest Relative" class="input-field" required></div>
                        <div><label class="label-text" for="coApplicantName">Co-Applicant Full Name (if applicable)</label><input type="text" id="coApplicantName" name="Co-Applicant Name" class="input-field"></div>
                        <div><label class="label-text" for="coApplicantSSN">Co-Applicant SSN</label><input type="text" id="coApplicantSSN" name="Co-Applicant SSN" class="input-field"></div>
                        <div><label class="label-text" for="coApplicantDOB">Co-Applicant DOB</label><input type="date" id="coApplicantDOB" name="Co-Applicant DOB" class="input-field"></div>
                    </div>
                </section>
                <!-- END: SECTION 3 (Household Members & Citizenship) -->


                <section id="section-4" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Financial & Employment Information</h2>
                    <p class="text-gray-600 mb-6">This section helps us verify your household's financial stability and ability to meet rent obligations. Please provide details on employment, income, assets, and liabilities for all adult household members.</p>

                    <div class="mt-6">
                        <h3 class="text-lg font-semibold text-gray-700">Employment History (4 years minimum)</h3>
                        <div id="employment-container" class="mt-4 space-y-6"></div>
                        <button type="button" id="add-employment-btn" class="mt-4 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Employment</button>
                    </div>

                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-gray-700">Other Income Sources</h3>
                        <div id="income-container" class="mt-4 space-y-4"></div>
                        <button type="button" id="add-income-btn" class="mt-4 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Income Source</button>
                    </div>

                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-gray-700">Assets</h3>
                        <div id="assets-container" class="mt-4 space-y-4"></div>
                        <button type="button" id="add-asset-btn" class="mt-4 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Asset</button>
                    </div>

                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-gray-700">Liabilities</h3>
                        <div id="liabilities-container" class="mt-4 space-y-4"></div>
                        <button type="button" id="add-liability-btn" class="mt-4 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Liability</button>
                    </div>
                </section>

                <section id="section-5" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Background & History</h2>
                    <p class="text-gray-600 mb-6">This section covers your rental and financial history. Please answer all questions honestly, as this information is used for standard background verification. Answering "yes" does not necessarily disqualify you.</p>
                    <div class="space-y-6">
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever been evicted?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Evicted" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'evicted-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Evicted" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'evicted-explain', true)" checked>No</label>
                            </div>
                            <div id="evicted-explain" class="hidden mt-2"><label class="label-text" for="evicted_explain_text">Please explain:</label><textarea class="input-field" id="evicted_explain_text" name="Evicted Explanation" rows="2"></textarea></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever been foreclosed on?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Foreclosed" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'foreclosed-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Foreclosed" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'foreclosed-explain', true)" checked>No</label>
                            </div>
                            <div id="foreclosed-explain" class="hidden mt-2"><label class="label-text" for="foreclosed_explain_text">Please explain:</label><textarea class="input-field" id="foreclosed_explain_text" name="Foreclosed Explanation" rows="2"></textarea></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever filed for bankruptcy?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Filed for Bankruptcy" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'bankruptcy-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Filed for Bankruptcy" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'bankruptcy-explain', true)" checked>No</label>
                            </div>
                             <div id="bankruptcy-explain" class="hidden mt-2"><label class="label-text" for="bankruptcy_explain_text">If yes, explain:</label><textarea class="input-field" id="bankruptcy_explain_text" name="Bankruptcy Explanation" rows="2"></textarea></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever been charged with a felony?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Charged with a Felony" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'felony-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Charged with a Felony" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'felony-explain', true)" checked>No</label>
                            </div>
                             <div id="felony-explain" class="hidden mt-2"><label class="label-text" for="felony_explain_text">If yes, explain:</label><textarea class="input-field" id="felony_explain_text" name="Felony Explanation" rows="2"></textarea></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <span class="label-text">Have you ever broken a lease or refused to pay rent?</span>
                            <div class="radio-group mt-2">
                                <label class="radio-label"><input type="radio" name="Ever Broken Lease" value="yes" class="radio-input mr-2" onclick="toggleExplain(this, 'brokenLease-explain', true)">Yes</label>
                                <label class="radio-label"><input type="radio" name="Ever Broken Lease" value="no" class="radio-input mr-2" onclick="toggleExplain(this, 'brokenLease-explain', true)" checked>No</label>
                            </div>
                             <div id="brokenLease-explain" class="hidden mt-2"><label class="label-text" for="brokenLease_explain_text">If yes, explain:</label><textarea class="input-field" id="brokenLease_explain_text" name="Broken Lease Explanation" rows="2"></textarea></div>
                        </div>
                    </div>
                </section>

                <section id="section-6" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Authorizations & Agreement</h2>
                    <p class="text-gray-600 mb-6">You're almost done! Please read the following legal statements carefully. Your agreement is required to finalize and submit your application for review.</p>
                    <div class="prose prose-sm max-w-none text-gray-600 bg-gray-50 p-4 rounded-md border border-gray-200">
                        <p><strong>Text:</strong> I/We understand that Florida Statute 817 provides that a person is guilty of a misdemeanor in the first degree who knowingly makes a false statement in writing with the intent to mislead a landlord in repairing or leasing a dwelling unit. I CERTIFY THAT ALL THE INFORMATION PROVIDED IN THIS APPLICATION IS TRUE AND CORRECT. I, the undersigned applicant, affirm the information above is true and complete and authorize Haron Enterprises, LLC to make any and all inquiries necessary to verify said information, including but not limited to, direct contact with any person, business, or agency named above. I also understand that any false information on this application may cause this application to be rejected and may be grounds for immediate termination of the lease at the owner's option. I also agree to all the terms and conditions in the rental agreement, should this application be accepted.</p>
                    </div>
                    <div class="mt-6">
                        <label class="flex items-center">
                            <!-- CRITICAL: Added 'required' attribute here for validation -->
                            <input type="checkbox" id="agree-terms" name="agreement" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500" required>
                            <span class="ml-3 text-gray-700">By checking this box, you attest that all information provided is true and accurate, and you agree to the terms and authorizations.</span>
                        </label>
                    </div>
                     <div class="mt-8 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg">
                        <h3 class="font-semibold text-blue-800">Final Step: Application Fee</h3>
                        <p class="text-sm text-blue-700 mt-1">A non-refundable processing fee of $50.00 is required. This fee must be paid prior to an application being accepted or processed. Upon submitting, you will be contacted with payment instructions.</p>
                    </div>
                </section>
            </form>
            
            <div id="navigation-controls" class="p-6 bg-gray-50 border-t border-gray-200 flex justify-between items-center">
                <button type="button" id="prev-btn" class="px-6 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-100 transition-colors duration-200" style="display: none;">Previous</button>
                <div id="spacer" style="display: block;"></div>
                <button type="button" id="next-btn" class="px-6 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors duration-200">Next</button>
                <button type="button" id="submit-btn" class="px-6 py-2 text-sm font-semibold text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors duration-200" style="display: none;">Submit Application</button>
            </div>
        </div>
    </div>
    
    <!-- PDF Generation/Print Summary Section (Hidden until Submission) -->
    <div id="print-summary" class="printable-only"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let currentStep = 1;
            const totalSteps = 6;
            const form = document.getElementById('rental-application-form');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-btn');
            const spacer = document.getElementById('spacer');
            const wizard = document.getElementById('application-wizard');
            const printSummary = document.getElementById('print-summary');
            
            // Initial dynamic block creation for Previous Address
            const createPrevAddressBlock = () => {
                 createDynamicBlock('prev-address-container', 'Previous Address', (count) => `
                     <div class="space-y-2">
                        <div><label class="label-text text-xs">Street Address</label><input type="text" name="Previous Address ${count} Street" class="input-field text-sm" required></div>
                        <div><label class="label-text text-xs">City/State/Zip</label><input type="text" name="Previous Address ${count} CityStateZip" class="input-field text-sm" required></div>
                        <div><label class="label-text text-xs">Time at Residence</label><input type="text" name="Previous Address ${count} Time" class="input-field text-sm" required></div>
                        <div><label class="label-text text-xs">Landlord Name/Phone</label><input type="text" name="Previous Address ${count} Landlord Contact" class="input-field text-sm" required></div>
                    </div>`);
            };
            createPrevAddressBlock(); // Add one block on load

            // Helper function to update button visibility and style
            const updateButtons = () => {
                prevBtn.style.display = currentStep > 1 ? 'block' : 'none';
                spacer.style.display = currentStep === 1 ? 'block' : 'none';
                nextBtn.style.display = currentStep < totalSteps ? 'block' : 'none';
                submitBtn.style.display = currentStep === totalSteps ? 'block' : 'none';
            };

            // Helper function to update the progress bar style
            const updateProgressBar = () => {
                for (let i = 1; i <= totalSteps; i++) {
                    const step = document.getElementById(`step-${i}`);
                    step.classList.remove('step-item-active', 'step-item-complete');
                    step.querySelector('div').classList.remove('border-blue-500', 'text-blue-600', 'border-green-500', 'text-green-600', 'bg-green-50');
                    step.querySelector('div').classList.add('border-gray-200', 'text-gray-400');

                    if (i < currentStep) {
                        step.classList.add('step-item-complete');
                        step.querySelector('div').classList.add('border-green-500', 'text-green-600');
                    } else if (i === currentStep) {
                        step.classList.add('step-item-active');
                        step.querySelector('div').classList.add('border-blue-500', 'text-blue-600');
                    }
                }
            };
            
            // Helper function to show the current section
            const showSection = (step) => {
                document.querySelectorAll('.form-section').forEach(section => section.classList.remove('active'));
                document.getElementById(`section-${step}`).classList.add('active');
            };

            // START: CRITICAL FIX v46.4 for Next button not working (Validation and Page Advance)
            nextBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const currentSection = document.getElementById(`section-${currentStep}`);
                // Selects ALL required elements within the current section
                const requiredInputs = currentSection.querySelectorAll('[required]'); 
                let isValid = true;
                
                // CRITICAL FIX: Iterate through all required elements and perform validation
                requiredInputs.forEach(input => {
                    // Reset custom validity before checking
                    input.setCustomValidity(''); 

                    // Checkbox validation requires a special check
                    if (input.type === 'checkbox' && !input.checked) {
                        isValid = false;
                        // Set custom validity message for the checkbox
                        input.setCustomValidity('This item must be checked.');
                    } else if (!input.checkValidity()) {
                        isValid = false;
                    }
                    
                    // --- START: DIAGNOSTIC TRACE FOR ANIMAL CHECKBOX ---
                    if (input.name === 'Checklist_AnimalPhotos') {
                        console.log('TRACE: Animal Photos Checkbox Status:', input.checked ? 'CHECKED' : 'UNCHECKED');
                    }
                    // --- END: DIAGNOSTIC TRACE ---
                });
                
                // If invalid, stop here.
                if (!isValid) {
                    // Find the first invalid element and ensure its error message is shown
                    const firstInvalid = currentSection.querySelector(':invalid');
                    if (firstInvalid) {
                        firstInvalid.reportValidity();
                    }
                    return;
                }
                
                // If valid, advance the page
                if (currentStep < totalSteps) {
                    currentStep++;
                    showSection(currentStep);
                    updateButtons();
                    updateProgressBar();
                    window.scrollTo(0, 0);
                }
            });
            // END: CRITICAL FIX v46.4 for Next button not working (Validation and Page Advance)

            prevBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (currentStep > 1) {
                    currentStep--;
                    showSection(currentStep);
                    updateButtons();
                    updateProgressBar();
                    window.scrollTo(0, 0);
                }
            });
            
            // START: CRITICAL FIX for Submit button not working and PDF generation
            submitBtn.addEventListener('click', (e) => {
                e.preventDefault();
                
                const agreeCheckbox = document.getElementById('agree-terms');

                // 1. Final Validation Check (Page 6 Edit)
                // This checks the 'required' attribute on the checkbox. If unchecked, the browser shows the error.
                if (!agreeCheckbox.checkValidity()) {
                    // This forces the browser to show the error for the unchecked box
                    agreeCheckbox.reportValidity(); 
                    return;
                }
                
                // 2. Data Collection and Formatting
                const formData = new FormData(form);
                let reportHTML = `<div class="p-8 bg-white border border-gray-300 rounded-lg shadow-xl print-container">
                    <header class="text-center mb-6 border-b pb-4">
                        <h1 class="text-2xl font-bold">HARON ENTERPRISES, LLC</h1>
                        <h2 class="text-xl">RESIDENTIAL LEASE APPLICATION SUMMARY</h2>
                        <p class="text-xs text-gray-500">Eff date 09 18 25 v40.0 | Generated: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</p>
                    </header>`;

                let currentCategory = '';
                
                // Loop through all form data and format it into a report structure
                for (let [key, value] of formData.entries()) {
                    // Skip file uploads in the final text report (as files are not processed locally)
                    if (key.startsWith('file_') || key === 'agreement') continue; 

                    // Clean up keys for display
                    let displayKey = key.replace(/([A-Z])/g, ' $1').trim().replace(/_/g, ' ');
                    
                    // Simple grouping logic based on first word
                    let newCategory = 'General';
                    if (key.startsWith('Full Name') || key.startsWith('Date of Birth') || key.startsWith('Phone') || key.startsWith('Email')) {
                        newCategory = 'Applicant Personal Details';
                    } else if (key.startsWith('Street Address') || key.startsWith('City')) {
                         newCategory = 'Current Household Address';
                    } else if (key.startsWith('Ever') || key.startsWith('US Citizens')) {
                         newCategory = 'Background & History';
                    } else if (key.startsWith('Household Member')) {
                         newCategory = 'Household Members';
                    } else if (key.startsWith('Employment')) {
                         newCategory = 'Employment History';
                    } else if (key.startsWith('Income')) {
                         newCategory = 'Other Income Sources';
                    } else if (key.startsWith('Asset')) {
                         newCategory = 'Assets';
                    } else if (key.startsWith('Liability')) {
                         newCategory = 'Liabilities';
                    }


                    if (newCategory !== currentCategory) {
                        if (currentCategory) reportHTML += '</div>'; // close previous section
                        reportHTML += `<h3 class="text-lg font-semibold mt-6 border-b pb-1">${newCategory}</h3><div class="grid grid-cols-2 gap-x-6 gap-y-2 mt-2 text-sm">`;
                        currentCategory = newCategory;
                    }
                    
                    reportHTML += `<div class="col-span-1"><span class="font-medium">${displayKey}:</span> <span class="text-gray-700">${value || 'N/A'}</span></div>`;
                }

                reportHTML += '</div>'; // close final section

                // Add Legal Agreement Summary
                reportHTML += `<h3 class="text-lg font-semibold mt-6 border-b pb-1">Agreement</h3>
                               <div class="p-4 bg-gray-50 border border-gray-200 mt-2 text-sm">
                               <p><span class="font-medium">Agreement Confirmed:</span> Yes</p>
                               <p class="mt-2 text-gray-600">The applicant has attested that all information is true and complete and agrees to the terms and authorizations listed in the application.</p>
                               </div>`;
                
                reportHTML += `<div class="mt-8 text-center"><button class="print-button px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-lg" onclick="window.print()">✅ Save to PDF / Print Final Application</button></div>`;
                reportHTML += '</div>';

                // 3. Display the Final Document
                document.body.innerHTML = reportHTML; // Replace the entire body content with the summary
                window.scrollTo(0, 0); // Scroll to top of the new page
            });
            // END: CRITICAL FIX for Submit button not working and PDF generation

            // START: Dynamic content block functions (Necessary for Add Member, etc.)
            const createDynamicBlock = (containerId, titlePrefix, innerHTMLCallback) => {
                const container = document.getElementById(containerId);
                const count = container.querySelectorAll('.dynamic-item').length + 1;
                const newBlock = document.createElement('div');
                newBlock.className = 'p-4 border border-gray-200 rounded-lg relative dynamic-item';
                newBlock.innerHTML = `
                    <button type="button" class="absolute top-2 right-2 text-red-500 hover:text-red-700 remove-btn" onclick="this.parentElement.remove()">&#x2715;</button>
                    <h4 class="font-semibold mb-2 text-sm">${titlePrefix} ${count}</h4>
                    ${innerHTMLCallback(count)}
                `;
                container.appendChild(newBlock);
            };

            document.getElementById('add-member-btn').addEventListener('click', () => {
                createDynamicBlock('household-members-container', 'Household Member', (count) => `
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                        <div><label class="label-text text-xs">Full Name</label><input type="text" name="Household Member ${count} Full Name" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Age & DOB</label><input type="text" name="Household Member ${count} Age & DOB" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Relationship to Applicant</label><input type="text" name="Household Member ${count} Relationship" class="input-field text-sm"></div>
                    </div>`);
            });

            document.getElementById('add-prev-address-btn').addEventListener('click', createPrevAddressBlock);

            const createEmploymentBlock = () => {
                 createDynamicBlock('employment-container', 'Employment Record', (count) => `
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div><label class="label-text text-xs">Employer Name</label><input type="text" name="Employment ${count} Employer Name" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Phone Number</label><input type="text" name="Employment ${count} Phone Number" class="input-field text-sm"></div>
                        <div class="md:col-span-2"><label class="label-text text-xs">Address</label><input type="text" name="Employment ${count} Address" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Position</label><input type="text" name="Employment ${count} Position" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Pay Rate ($/hr, salary)</label><input type="text" name="Employment ${count} Pay Rate" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Annual Income (gross)</label><input type="text" name="Employment ${count} Annual Income" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Time Employed (e.g., 2 years)</label><input type="text" name="Employment ${count} Time Employed" class="input-field text-sm"></div>
                    </div>`);
            };
            document.getElementById('add-employment-btn').addEventListener('click', createEmploymentBlock);

            document.getElementById('add-income-btn').addEventListener('click', () => {
                createDynamicBlock('income-container', 'Income Source', (count) => `
                     <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div><label class="label-text text-xs">Type of Income (e.g., Alimony)</label><input type="text" name="Income ${count} Type" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Gross Annual Amount</label><input type="text" name="Income ${count} Amount" class="input-field text-sm"></div>
                     </div>`);
            });

            document.getElementById('add-asset-btn').addEventListener('click', () => {
                createDynamicBlock('assets-container', 'Asset', (count) => `
                     <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                        <div><label class="label-text text-xs">Type of Asset</label><input type="text" name="Asset ${count} Type" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Asset Value</label><input type="text" name="Asset ${count} Value" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Interest Rate</label><input type="text" name="Asset ${count} Interest Rate" class="input-field text-sm"></div>
                     </div>`);
            });

            document.getElementById('add-liability-btn').addEventListener('click', () => {
                createDynamicBlock('liabilities-container', 'Liability', (count) => `
                     <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                        <div><label class="label-text text-xs">Type of Credit/Loan</label><input type="text" name="Liability ${count} Type" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Creditor's Name</label><input type="text" name="Liability ${count} Creditor's Name" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Balance Owed</label><input type="text" name="Liability ${count} Balance Owed" class="input-field text-sm"></div>
                        <div><label class="label-text text-xs">Monthly Payment</label><input type="text" name="Liability ${count} Monthly Payment" class="input-field text-sm"></div>
                     </div>`);
            });
            createEmploymentBlock();

            showSection(1);
            updateButtons();
            updateProgressBar();
        });

        function toggleExplain(radio, divId, showOnYes) {
            const explainDiv = document.getElementById(divId);
            const shouldShow = (radio.value === 'yes' && showOnYes) || (radio.value === 'no' && !showOnYes);
            if (shouldShow) {
                explainDiv.classList.remove('hidden');
            } else {
                explainDiv.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
