<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haron Enterprises, LLC - Residential Lease Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Professional Neutral -->
    <!-- Application Structure Plan: Multi-step wizard with client-side PDF generation (most reliable method without a server). -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            background-color: #f8f7f4; 
            font-family: 'Inter', sans-serif;
        }
        @import url('https://rsms.me/inter/inter.css');
        .form-section {
            display: none;
        }
        .form-section.active {
            display: block;
        }
        .step-item-active {
            border-color: #3b82f6;
            color: #3b82f6;
        }
        .step-item-complete {
            border-color: #16a34a;
            color: #16a34a;
            background-color: #f0fdf4;
        }
        .input-field {
            @apply w-full px-4 py-2 text-gray-700 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200;
        }
        .label-text {
            @apply block text-sm font-medium text-gray-600 mb-1;
        }
        /* START: FIX for Red X on dynamic items */
        .dynamic-item .remove-btn { 
            display: none; 
        }
        .dynamic-item:hover .remove-btn {
            display: block; 
        }
        /* END: FIX for Red X on dynamic items */
        /* Style for print output */
        @media print {
            body { background: #fff; }
            #navigation-controls, #progress-bar, #header, #footer, #application-wizard { display: none !important; }
            .printable-only { display: block !important; }
            .print-button { display: none !important; }
            .no-print { display: none !important; }
        }
        .printable-only {
            display: none;
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div class="container mx-auto px-4 py-8 md:py-12 no-print">
        <header id="header" class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Haron Enterprises, LLC</h1>
            <p class="mt-2 text-lg text-gray-600">Residential Lease Application</p>
            <p class="text-sm text-gray-600 font-semibold">In Accordance with Seminole County NSP Rentals Program</p>
            <p class="text-sm text-red-600 font-bold">AII INCOMPLETE applications will be REJECTED. Tel: (407) 702-3281 / Fax: (866) 858-5371</p>
            <p class="text-sm text-gray-500">Eff date 10 01 25 v49.3 Final</p>
        </header>

        <div id="application-wizard" class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
            <div id="progress-bar" class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <div id="step-1" class="step-item step-item-active text-center w-1/6">
                        <div class="border-b-4 pb-2 text-xs md:text-sm font-semibold">Checklist</div>
                    </div>
                     <div id="step-2" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">Address</div>
                    </div>
                     <div id="step-3" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">Household</div>
                    </div>
                     <div id="step-4" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">Financial</div>
                    </div>
                     <div id="step-5" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">History</div>
                    </div>
                    <div id="step-6" class="step-item text-center w-1/6">
                        <div class="border-b-4 border-gray-200 pb-2 text-xs md:text-sm font-semibold text-gray-400">Final</div>
                    </div>
                </div>
            </div>

            <!-- CRITICAL FIX: Removed action attribute entirely for self-contained operation -->
            <form id="rental-application-form" class="p-6 md:p-8">
                <div id="status-message" class="text-sm px-4 py-2 rounded-md mb-4 hidden" role="alert"></div>
                
                <!-- START: SECTION 1 (Intro/Checklist) - SIMPLEST LAYOUT FOR TESTING -->
                <section id="section-1" class="form-section active">
                    <h2 class="text-2xl font-semibold mb-3 text-gray-800">APPLICATION CHECKLIST (TEST MODE)</h2>
                    <p class="text-red-500 font-semibold mb-6 border-b pb-4">ONLY FILL NAME AND DATE TO TEST ADVANCEMENT.</p>
                    
                    <div class="space-y-6">
                        
                        <div class="border p-4 rounded-lg bg-gray-50">
                            <h3 class="text-lg font-semibold mb-3 text-gray-700 border-b pb-1">Basic Identification</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label class="label-text" for="fullName">Full Name</label><input type="text" id="fullName" name="Full Name" class="input-field" required></div>
                                <div><label class="label-text" for="dob">Date of Birth</label><input type="date" id="dob" name="Date of Birth" class="input-field" required></div>
                            </div>
                        </div>
                        <!-- Checkboxes REMOVED for testing -->
                    </div>
                </section>
                <!-- END: SECTION 1 (Intro/Checklist) -->

                <!-- START: SECTION 2 (Address/Rental History - RESTORED V42 CONTENT) -->
                <section id="section-2" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Detailed Applicant & Rental History</h2>
                    <p class="text-gray-600 mb-6">Complete all identification, contact, and address fields below. Rental history must cover the last five years.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        
                        <!-- Column 1: Identification/Instructions -->
                        <div class="md:col-span-1 space-y-4 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                            <h3 class="text-lg font-semibold text-gray-700 border-b pb-1">Identification & Vehicle</h3>
                            <div><label class="label-text" for="ssn">Social Security Number</label><input type="text" id="ssn" name="Social Security Number" class="input-field" required></div>
                            <div><label class="label-text" for="dl">Driver's License #</label><input type="text" id="dl" name="Driver's License #" class="input-field" required></div>
                            <div><label class="label-text" for="vehicleMake">Vehicle Make & Model</label><input type="text" id="vehicleMake" name="Vehicle Make & Model" class="input-field"></div>
                            <div><label class="label-text" for="vehicleTag">Vehicle Tag #</label><input type="text" id="vehicleTag" name="Vehicle Tag #" class="input-field"></div>
                            <div class="space-y-2 pt-2">
                                <span class="label-text">Armed Services Member?</span>
                                <div class="radio-group">
                                    <label class="radio-label"><input type="radio" name="Armed Services Member" value="yes" class="radio-input mr-2">Yes</label>
                                    <label class="radio-label"><input type="radio" name="Armed Services Member" value="no" class="radio-input mr-2" checked>No</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Column 2: Current Address & Landlord -->
                        <div class="md:col-span-1 space-y-4">
                            <h3 class="text-lg font-semibold mb-2 text-gray-800 border-b pb-1">Current Residence Details</h3>
                            <div><label class="label-text" for="currentStreet">Street Address</label><input type="text" id="currentStreet" name="Current Street Address" class="input-field" required></div>
                            <div><label class="label-text" for="currentCity">City</label><input type="text" id="currentCity" name="Current City" class="input-field" required></div>
                            <div><label class="label-text" for="currentState">State</label><input type="text" id="currentState" name="Current State" class="input-field" required></div>
                            <div><label class="label-text" for="currentZip">Zip Code</label><input type="text" id="currentZip" name="Current Zip Code" class="input-field" required></div>
                            <div><label class="label-text" for="timeAtCurrent">Time at Current Residence</label><input type="text" id="timeAtCurrent" name="Time at Current Residence" class="input-field" required></div>
                            <div><label class="label-text" for="currentLandlord">Current Landlord/Mortgage Co.</label><input type="text" id="currentLandlord" name="Current Landlord/Mortgage Co." class="input-field" required></div>
                            <div><label class="label-text" for="currentLandlordPhone">Landlord Phone</label><input type="tel" id="currentLandlordPhone" name="Current Landlord Phone" class="input-field" required></div>
                        </div>

                        <!-- Column 3: Previous Address (Dynamic Block) -->
                         <div class="md:col-span-1 space-y-4">
                            <h3 class="text-lg font-semibold mb-2 text-gray-800 border-b pb-1">Previous Residence History</h3>
                             <div id="prev-address-container" class="space-y-4"></div>
                            <button type="button" id="add-prev-address-btn" class="mt-2 text-sm font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-200">+ Add Previous Residence</button>
                        </div>
                    </div>
                </section>
                <!-- END: SECTION 2 (Address/Rental History - RESTORED V42 CONTENT) -->


                <!-- START: SECTION 3 (Household Members & Citizenship - Placeholder) -->
                <section id="section-3" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Household & Citizenship Details</h2>
                    <p class="text-gray-600 mb-6">PLACEHOLDER SECTION - Fill Page 1 to continue to Page 4.</p>
                </section>
                <!-- END: SECTION 3 (Household Members & Citizenship - Placeholder) -->


                <!-- START: SECTION 4 (Financial & Employment - Placeholder) -->
                <section id="section-4" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Financial & Employment Information</h2>
                    <p class="text-gray-600 mb-6">PLACEHOLDER SECTION - Fill Page 1 to continue to Page 5.</p>
                </section>
                <!-- END: SECTION 4 (Financial & Employment - Placeholder) -->

                <section id="section-5" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Background & History</h2>
                    <p class="text-gray-600 mb-6">PLACEHOLDER SECTION - Fill Page 1 to continue to Page 6.</p>
                </section>

                <section id="section-6" class="form-section">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Authorizations & Agreement</h2>
                    <p class="text-gray-600 mb-6">You're almost done! Please read the following legal statements carefully. Your agreement is required to finalize and submit your application for review.</p>
                    <div class="prose prose-sm max-w-none text-gray-600 bg-gray-50 p-4 rounded-md border border-gray-200">
                        <p><strong>Text:</strong> I/We understand that Florida Statute 817 provides that a person is guilty of a misdemeanor in the first degree who knowingly makes a false statement in writing with the intent to mislead a landlord in repairing or leasing a dwelling unit. I CERTIFY THAT ALL THE INFORMATION PROVIDED IN THIS APPLICATION IS TRUE AND CORRECT. I, the undersigned applicant, affirm the information above is true and complete and authorize Haron Enterprises, LLC to make any and all inquiries necessary to verify said information, including but not limited to, direct contact with any person, business, or agency named above. I also understand that any false information on this application may cause this application to be rejected and may be grounds for immediate termination of the lease at the owner's option. I also agree to all the terms and conditions in the rental agreement, should this application be accepted.</p>
                    </div>
                    <div class="mt-6">
                        <label class="flex items-center">
                            <input type="checkbox" id="agree-terms" name="agreement" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500" required>
                            <span class="ml-3 text-gray-700">By checking this box, you attest that all information provided is true and accurate, and you agree to the terms and authorizations.</span>
                        </label>
                    </div>
                     <div class="mt-8 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg">
                        <h3 class="font-semibold text-blue-800">Final Step: Application Fee</h3>
                        <p class="text-sm text-blue-700 mt-1">A non-refundable processing fee of $50.00 is required. This fee must be paid prior to an application being accepted or processed. Upon submitting, you will be contacted with payment instructions.</p>
                    </div>
                </section>
            </form>
            
            <div id="navigation-controls" class="p-6 bg-gray-50 border-t border-gray-200 flex justify-between items-center">
                <button type="button" id="prev-btn" class="px-6 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-100 transition-colors duration-200" style="display: none;">Previous</button>
                <div id="spacer" style="display: block;"></div>
                <button type="button" id="next-btn" class="px-6 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors duration-200">Next</button>
                <button type="button" id="submit-btn" class="px-6 py-2 text-sm font-semibold text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors duration-200" style="display: none;">Submit Application</button>
            </div>
        </div>
    </div>
    
    <!-- PDF Generation/Print Summary Section (Hidden until Submission) -->
    <div id="print-summary" class="printable-only"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let currentStep = 1;
            const totalSteps = 6;
            const form = document.getElementById('rental-application-form');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-btn');
            const spacer = document.getElementById('spacer');
            
            // Initial dynamic block creation for Previous Address
            const createPrevAddressBlock = () => {
                 createDynamicBlock('prev-address-container', 'Previous Address', (count) => `
                     <div class="space-y-2">
                        <div><label class="label-text text-xs">Street Address</label><input type="text" name="Previous Address ${count} Street" class="input-field text-sm" required></div>
                        <div><label class="label-text text-xs">City/State/Zip</label><input type="text" name="Previous Address ${count} CityStateZip" class="input-field text-sm" required></div>
                        <div><label class="label-text text-xs">Time at Residence</label><input type="text" name="Previous Address ${count} Time" class="input-field text-sm" required></div>
                        <div><label class="label-text text-xs">Landlord Name/Phone</label><input type="text" name="Previous Address ${count} Landlord Contact" class="input-field text-sm" required></div>
                    </div>`);
            };
            createPrevAddressBlock(); // Add one block on load

            // Helper function to update button visibility and style
            const updateButtons = () => {
                prevBtn.style.display = currentStep > 1 ? 'block' : 'none';
                spacer.style.display = currentStep === 1 ? 'block' : 'none';
                nextBtn.style.display = currentStep < totalSteps ? 'block' : 'none';
                submitBtn.style.display = currentStep === totalSteps ? 'block' : 'none';
            };

            // Helper function to update the progress bar style
            const updateProgressBar = () => {
                for (let i = 1; i <= totalSteps; i++) {
                    const step = document.getElementById(`step-${i}`);
                    step.classList.remove('step-item-active', 'step-item-complete');
                    step.querySelector('div').classList.remove('border-blue-500', 'text-blue-600', 'border-green-500', 'text-green-600', 'bg-green-50');
                    step.querySelector('div').classList.add('border-gray-200', 'text-gray-400');

                    if (i < currentStep) {
                        step.classList.add('step-item-complete');
                        step.querySelector('div').classList.add('border-green-500', 'text-green-600');
                    } else if (i === currentStep) {
                        step.classList.add('step-item-active');
                        step.querySelector('div').classList.add('border-blue-500', 'text-blue-600');
                    }
                }
            };
            
            // Helper function to show the current section
            const showSection = (step) => {
                document.querySelectorAll('.form-section').forEach(section => section.classList.remove('active'));
                document.getElementById(`section-${step}`).classList.add('active');
            };

            // START: CRITICAL FIX v48.4 for Next button not working (Guaranteed Validation)
            nextBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const currentSection = document.getElementById(`section-${currentStep}`);
                
                // CRITICAL FIX: We must use the section's checkValidity() method and force the browser to show errors
                // This is the most reliable way to make the button work.
                let isValid = true;
                const requiredInputs = currentSection.querySelectorAll('[required]');

                // Simple loop to check required fields in the current section
                requiredInputs.forEach(input => {
                    if (!input.checkValidity()) {
                        isValid = false;
                    }
                });
                
                // If invalid, trigger the reportValidity on the current section.
                if (!isValid) {
                    // This forces the browser to show the error bubbles ("edits") on the original form.
                    const firstInvalid = currentSection.querySelector(':invalid');
                    if (firstInvalid) {
                        firstInvalid.reportValidity();
                    }
                    return;
                }
                
                // If valid, advance the page
                if (currentStep < totalSteps) {
                    currentStep++;
                    showSection(currentStep);
                    updateButtons();
                    updateProgressBar();
                    window.scrollTo(0, 0);
                }
            });
            // END: CRITICAL FIX v48.4 for Next button not working (Guaranteed Validation)

            prevBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (currentStep > 1) {
                    currentStep--;
                    showSection(currentStep);
                    updateButtons();
                    updateProgressBar();
                    window.scrollTo(0, 0);
                }
            });
            
            // START: Submit button logic
            submitBtn.addEventListener('click', (e) => {
                e.preventDefault();
                
                const agreeCheckbox = document.getElementById('agree-terms');

                // 1. Final Validation Check (Page 6 Edit)
                if (!agreeCheckbox.checkValidity()) {
                    agreeCheckbox.reportValidity(); 
                    return;
                }
                
                // 2. Data Collection and Formatting (Placeholder logic for PDF Generation)
                const formData = new FormData(form);
                let reportHTML = `<div class="p-8 bg-white border border-gray-300 rounded-lg shadow-xl print-container">
                    <header class="text-center mb-6 border-b pb-4">
                        <h1 class="text-2xl font-bold">HARON ENTERPRISES, LLC</h1>
                        <h2 class="text-xl">FINAL APPLICATION SUMMARY</h2>
                        <p class="text-xs text-gray-500">Generated: ${new Date().toLocaleDateString()}</p>
                    </header>
                    <h3 class="text-lg font-semibold mt-6 border-b pb-1">Applicant Data Collected</h3>
                    <div class="grid grid-cols-2 gap-x-6 gap-y-2 mt-2 text-sm">
                        <!-- Display captured data (Simplified) -->
                        <div class="col-span-1"><span class="font-medium">Full Name:</span> ${formData.get('Full Name')}</div>
                        <div class="col-span-1"><span class="font-medium">Date of Birth:</span> ${formData.get('Date of Birth')}</div>
                        <div class="col-span-2 mt-4 text-center"><p class="text-red-600 font-bold">This is the final document. Please click the button below to save to PDF.</p></div>
                    </div>
                
                    <div class="mt-8 text-center">
                        <button class="print-button px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-lg" onclick="window.print()">âœ… Save to PDF / Print Final Application</button>
                    </div>
                </div>`;

                // 3. Display the Final Document
                document.body.innerHTML = reportHTML; // Replace the entire body content with the summary
                window.scrollTo(0, 0); // Scroll to top of the new page
            });
            // END: Submit button logic

            // START: Dynamic content block functions (Necessary for Add Member, etc.)
            const createDynamicBlock = (containerId, titlePrefix, innerHTMLCallback) => {
                const container = document.getElementById(containerId);
                const count = container.querySelectorAll('.dynamic-item').length + 1;
                const newBlock = document.createElement('div');
                newBlock.className = 'p-4 border border-gray-200 rounded-lg relative dynamic-item';
                newBlock.innerHTML = `
                    <button type="button" class="absolute top-2 right-2 text-red-500 hover:text-red-700 remove-btn" onclick="this.parentElement.remove()">&#x2715;</button>
                    <h4 class="font-semibold mb-2 text-sm">${titlePrefix} ${count}</h4>
                    ${innerHTMLCallback(count)}
                `;
                container.appendChild(newBlock);
            };

            // This function is defined but not attached to an event listener in this simplified version
            const createPrevAddressBlock = () => {
                 createDynamicBlock('prev-address-container', 'Previous Address', (count) => `
                     <div class="space-y-2">
                        <div><label class="label-text text-xs">Street Address</label><input type="text" name="Previous Address ${count} Street" class="input-field text-sm" required></div>
                        <div><label class="label-text text-xs">City/State/Zip</label><input type="text" name="Previous Address ${count} CityStateZip" class="input-field text-sm" required></div>
                        <div><label class="label-text text-xs">Time at Residence</label><input type="text" name="Previous Address ${count} Time" class="input-field text-sm" required></div>
                        <div><label class="label-text text-xs">Landlord Name/Phone</label><input type="text" name="Previous Address ${count} Landlord Contact" class="input-field text-sm" required></div>
                    </div>`);
            };
            // END: Dynamic content block functions

            // Initial setup
            showSection(1);
            updateButtons();
            updateProgressBar();
        });
    </script>
</body>
</html>
